\begin{frame}
\frametitle{About This Work...}

\emph{Spatio-temporal Joins on Symbolic Indoor Tracking Data}.~\cite{DBLP:conf/icde/LuYCJ11} \\
H.~Lu, B.~Yang, and C.~S. Jensen.\\~\\

\begin{itemize}
  \item Published at \emph{ICDE' 2011}.
  \item Studies the probabilistic, spatio-temporal joins on hisorical indoor tracking data.
  \item Two-phase hash-based algorithms are proposed for the point and interval joins.
  \item A filter-and-refine framework, along with spatial indexes and pruning rules.
\end{itemize}

\end{frame}
%------------------------------------------------

\begin{frame}
\frametitle{Motivation}

\begin{itemize}
  \item Huge amount of tracking data serves as a foundation for a wide variety of indoor applications and services.\cite{jensen2010indoor}
    \begin{fitemize}
      \item shopping mall, airports, office buildings, akin to those enabled by outdoor GPS
      \item hot area detection, space planning, security control, movement pattern discovery
    \end{fitemize}

  \item Spatio-temporal joins fall short in indoor setting.
    \begin{fitemize}
      \item indoor space consists of semantic entities enable or constrain movement
      \item semantics of indoor space call for novel spatio-temporal join predicates
      \item indoor positioning technologies differ fundamentally from outdoor setting, low accuracy and sampling frequency
    \end{fitemize}

  \item Joins on indoor tracking data call for new definition and new implementation techniques that take into account:
  \begin{fitemize}
    \item specifics of indoor space
    \item limitations of indoor positioning
  \end{fitemize}
\end{itemize}

\end{frame}
%------------------------------------------------

%------------------------------------------------

\begin{frame}
\frametitle{Preliminaries: Symbolic Indoor Tracking}

\begin{figure}[tb]
  \includegraphics[width=\columnwidth]{figures/2-4/2-4-1.pdf}
\end{figure}

\begin{enumerate}
  \ssize{
  \item $\mn{C2P: C \rightarrow 2^P}$ maps a cell to a set of indoor partitions
  \item $\mn{D2C: D \rightarrow 2^C}$ maps a device to a set of corresponding cells
  \item According to Deployment Graph, for partitioning device, $\mn{D2C(device_{13})} = \{ C_{10},C_{13} \} \cup \{ C_{12},C_{13} \} = \{ C_{10},C_{12},C_{13} \}$
  \item For presence device, $\mn{D2C(device_{25})} = \{ C_{21},C_{22} \}$ as the cells intersect its detection range.
  \item $\mn{D2C: D \rightarrow 2^C}$ is useful as it captures the possible movements of objects.
  }
\end{enumerate}

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Preliminaries: Symbolic Indoor Tracking}

\begin{columns}[c]
  \column{.52\textwidth}
  \begin{figure}[tb]
    \includegraphics[width=\columnwidth]{figures/2-4/2-4-2.pdf}
  \end{figure}

  \column{.48\textwidth}
  \begin{fitemize}
    \item \conceptbf{Object Tracking Table} $\mn{OTT}$ records the converted trajectories with schema $\mn{(ID, objectID, deviceID, t_s, t_e)}$
    ~\\
    \item a record states that the object $\mn{objectID}$ is observed by the device $\mn{deviceID}$ in the closed interval from time $\mn{t_s}$ to $\mn{t_e}$.
  \end{fitemize}

\end{columns}

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Problem Definitions}

Given an $\mn{OTT}$, it is of interesting to identify object pairs that join w.r.t some specific spatio-temporal join predicate.
\begin{fitemize}
  \item to know all pair of individuals that were probably at the same gate when a particular event (terrorist attack) occurred in a large airport.
\end{fitemize}
~\\
Due to tracking uncertainty, only interested in those objects that satisfy the join predicate with some given probability (specified threshold).
\\~\\
The joins are effectively \emph{self-joins} because all tracking data is contained in a single $\mn{OTT}$.

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Problem Definition I}

\textrm{One can apply a join predicate to a time point to find pairs that join at that particular time point...}
\\~\\
\begin{definition}[\ssize{Probabilistic Threshold Indoor Spatio-temporal Join--PTISSJ}]
  \textrm{
  \ssize{
  Given an $\mn{OTT}$, a join predicate $\mn{P}$, a time point $\mn{t}$, and a threshold value $\mn{M \in (0,1]}$, a probabilistic threshold indoor spatio-temporal join  $\mn{\Join_{P,t,M}(OTT) = \{ (o_i, o_j) | o_i, o_j \in O  \wedge o_i \neq o_j \wedge pr(P(o_i, o_j, t)) >M \}}$, where $\mn{pr(P(o_i,o_j,t))}$ is the \textbf{Timeslice Join Probability} of $\mn{o_i, o_j}$ at time $\mn{t}$, i.e., the probability that predicate $\mn{P(o_i,o_j,t)}$ is true.
  }}
\end{definition}

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Problem Definition II}

\textrm{It's also interesting to know object pairs satisfy the predicate for some consecutive timestamp...}
\\~\\
\begin{definition}[\ssize{Probabilistic Threshold $k$ Indoor Spatio-temporal Join--PT$k$ISSJ}]
  \textrm{
  \ssize{
  Given an $\mn{OTT}$, a join predicate $\mn{P}$, a time interval $\mn{I = [t_m, t_n] (m < n)}$, an integer $\mn{k(0 < k \leq n - m)}$, and a threshold value $\mn{M \in (0,1]}$, a probabilistic $\mn{k}$ threshold indoor spatio-temporal join
  \begin{equation*}
    \begin{split}
    &\mn{\Join_{P,I,k,M}(OTT) = \{ (o_i, o_j) | o_i, o_j \in O \wedge o_i \neq o_j \wedge } \\
    &\mn{\exists s \in m...n -k + 1 (\forall\delta \in 0...k-1 (pr(P(o_i, o_j, t_{s+\delta})) > M)) \} }
    \end{split}
  \end{equation*}
  }}
\end{definition}

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Uncertainty Model for Indoor Tracking}

\textrm{For outdoor moving objects~\cite{cheng2004querying}, \conceptbf{Uncertainty Region}, denoted by $\mn{UR(o_i,t)}$, is a region such that $\mn{o_i}$ must be in this region at time $\mn{t}$.}\\~

In general terms, an object $\mn{o_i}$'s location can be modeled as a random variable $\mn{l}$ associated with a probability density function $\mn{f_{o_i}(l,t)}$ that has non-zero values only in $\mn{o_i}$'s suncertainty region $\mn{UR(o_i, t)}$.~\cite{DBLP:conf/edbt/YangLJ10}

\begin{equation}
  \mn{\int_{l \in UR(o_i,t)} f_{o_i}(l,t) dl = 1}
\end{equation}

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Object State in OTT}

\begin{columns}[c]

\column{.45\textwidth}
\begin{figure}[tb]
  \includegraphics[width=\columnwidth]{figures/2-4/2-4-3.pdf}
\end{figure}

\column{.55\textwidth}
\begin{definition}[Active State]
  \textrm{
  \ssize{
  Given an object $\mn{o_i}$ and a time point $\mn{t}$, if a tracking record $\mn{rd_{cov}}$ is found in $\mn{OTT}$ such that $\mn{rd_{cov}.objectID = o_i}$ and $\mn{t \in [rd_{cov}.t_s, rd_{cov}.t_e]}$, $\mn{o_i}$ is in the \conceptbf{active state} at time $\mn{t}$.
  }}
\end{definition}

\end{columns}

\begin{definition}[Inactive State]
  \textrm{
  \ssize{
  Given an object $\mn{o_i}$ and a time point $\mn{t}$, if no record $\mn{rd_{cov}}$ is found in $\mn{OTT}$, $\mn{o_i}$ is in the \conceptbf{inactive state} at time $\mn{t}$. Instead, two tracking records of $\mn{o_i}$ called $\mn{rd_{pre}}$ and $\mn{rd_{suc}}$, can be found in $\mn{OTT}$, such that they are consecutive in the sense that $\mn{rd_{pre}.t_e < t < rd_{suc}.t_s}$ and there is no record for $\mn{o_i}$ between times $\mn{rd_{pre}.t_e}$ and $\mn{rd_{suc}.t_s}$.
  }}
\end{definition}

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Uncertainty Region in the Active State}

\begin{columns}[c]
  \column{.52\textwidth}
  \vspace{-10pt}
  \begin{figure}[tb]
    \includegraphics[width=\columnwidth]{figures/2-4/2-4-2.pdf}
  \end{figure}
  \vspace{-15pt}
  \begin{example}
    \textrm{
    \ssize{
    $\mn{t = t_5}$, $\mn{rd_{cov} = rd_3}$ and $\mn{rd_{pre} = rd_1}$, which tells $\mn{o_i}$ left $\mn{dev_4}$'s detection range at time $\mn{t_2}$, and is currently detected by $\mn{dev_2}$.
    }}
  \end{example}

  \column{.48\textwidth}
  \vspace{-10pt}
  \begin{figure}[tb]
    \includegraphics[width=\columnwidth]{figures/2-4/2-4-4.pdf}
  \end{figure}
  \ssize{
  \textbf{Step 1:}
  UR is the detection range of device $\mn{rd_{cov}.deviceID}$, denote as:
  \begin{equation*}
  \begin{split}
    \mn{ C_{cov} = } &\mn { Cir(Loc(rd_{cov}.deviceID), }\\
    &\mn{ Rad(rd_{cov}.deviceID)) }
  \end{split}
  \end{equation*}
  ~\\
  \textbf{Step 2:}
  UR should consider the $\mn{rd_{pre}}$'s \emph{maximum speed bounding ring}(MSBR):
  \tiny{
  \begin{equation*}
  \begin{split}
    &\mn{ UR(o_i, t) = C_{cov} \cap Ring(Loc(rd_{pre}.deviceID), } \\
    &\mn{ Rad(rd_{pre}.deviceID), V_i \cdot (t - rd_{pre}.t_e) ) }
  \end{split}
  \end{equation*}
  }
  }
\end{columns}

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Uncertainty Region in the Inactive State}

\begin{columns}[c]

  \column{.52\textwidth}
  \vspace{-10pt}
  \begin{figure}[tb]
    \includegraphics[width=\columnwidth]{figures/2-4/2-4-2.pdf}
  \end{figure}
  \vspace{-15pt}
  \begin{example}
    \textrm{
    \ssize{
    $\mn{t = t_{19}}$, $\mn{rd_{pre} = rd_6}$ and $\mn{rd_{suc} = rd_8}$, since $\mn{rd_6.t_e = t_{16} < t_{19} < rd_8.t_s = t_{21}}$. we have $\mn{dev_p = dev_{12}}$ and $\mn{dev_s = dev_{13}}$
    }}
  \end{example}

  \column{.48\textwidth}
  \vspace{-10pt}
  \begin{figure}[tb]
    \includegraphics[width=\columnwidth]{figures/2-4/2-4-5.pdf}
  \end{figure}
  \ssize{
  \textbf{Step 1:}
  Determine the possible cells in which the object can be in the inactive period:
  \begin{equation*}
    \mn{ Cells_{mid} = D2C(dev_p) \cup D2C(dev_s)}
  \end{equation*}
  ~\\
  \textbf{Step 2:}
  UR is constrained by two \emph{maximum speed bounding ring}(MSBR)s of $\mn{rd_{pre}}$ and $\mn{rd_{suc}}$:
  \tiny{
  \begin{equation*}
  \begin{split}
    \mn{ UR(o_i, t) = \bigcup_{c \in Cells_{mid}} c \cap R_{pre} \cap R_{suc} }
  \end{split}
  \end{equation*}
  }
  }
\end{columns}

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Join Probability Evaluation}

\begin{definition}[the \emph{same X} predicate]
  \textrm{
  \ssize{
    termed as $\mn{P_X}$, where $\mn{X}$ represents an indoor region type. $\mn{IR_X}$ represents all $\mn{X}$ type regions ($\mn{X}$-regions).
  }
  }
\end{definition}
~\\
\begin{example}[the \emph{same room} predicate]
  \textrm{
  \ssize{
    Given two objects $\mn{o_i, o_j}$ at a time point $\mn{t}$, the \emph{same room} predicate $\mn{P_X(o_i, o_j, t)}$ evaluates to true if both $\mn{o_i, o_j}$ were located in a same room $\mn{rm \in IR_X}$. Other predicates can be \emph{same floor, same reserach group (maps to several rooms)}.
  }
  }
\end{example}
~\\
The \emph{same X} predicates are more practical than Euclidean distance based join predicates in indoor space.

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Join Probability Evaluation}
\vspace{-10pt}
\begin{definition}[``be located at'' predicate probability]
  \textrm{
  \ssize{
    Given an object $\mn{o_i}$, an $\mn{X}$-region $\mn{x_l \in IR_X}$, and a time $\mn{t}$, predicate $\Theta(o_i, x_l, t)$ indicate that $\mn{o_i}$ was located in $\mn{x_l}$ at $\mn{t}$. The probability that $\mn{\Theta}$ is satisfied is defined as:
    \begin{equation*}
      \mn{pr(\Theta(o_i, x_l, t)) = \frac{Area(UR(o_i, t) \cap x_l)}{Area(UR(o_i, t))}}
    \end{equation*}
  }
  }
\end{definition}

\begin{definition}[the \emph{same X} predicate probability]
  \textrm{
  \ssize{
    The probability that $\mn{o_i}$ and $\mn{o_j}$ were located in the same $\mn{x_l}$ at $\mn{t}$, indicated by $\mn{pr(P_{x_l}(o_i, o_j, t))}$ is defined as:
    \begin{equation*}
      \mn{pr(P_{x_l}(o_i, o_j, t)) = pr(\Theta(o_i, x_l, t)) \cdot pr(\Theta(o_j, x_l, t)) }
    \end{equation*}
    Therefore, the porbability that $\mn{o_i}$ and $\mn{o_j}$ satisfy a \emph{same X} predicate at time $\mn{t}$ can be defined as:
    \begin{equation*}
      \mn{pr(P_X(o_i, o_j, t)) = \max_{x_l \in IR_X} pr(P_{x_l}(o_i, o_j, t)) }
    \end{equation*}
  }
  }
\end{definition}

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Indexing the Indoor Tracking Data}

\textrm{to determine the \emph{Uncertainty Region} during join processing, it needs to retrieve the records $\mn{rd_{cov}}$ and $\mn{rd_{pre}}$ for active objects or $\mn{rd_{pre}}$ and $\mn{rd_{suc}}$ for inactive state.}
\\~\\
to index $\mn{OTT}$ with an augmented 1D R-tree, where each leaf entry has the form $\mn{(t^{\vdash},t^{\dashv},Ptr_{p},Ptr_{c})}$. $\mn{t^{\vdash} = rd_p.t_e}$, $\mn{t^{\dashv} = rd_c.t_e}$, $\mn{Ptr_p}$ and $\mn{Ptr_c}$ points to $\mn{rd_p}$ and $\mn{rd_c}$ respectively.

\begin{fitemize}
  \item if $\mn{t \geq rd_c.t_s}$, $\mn{o_i}$ is active, $\mn{rd_p \rightarrow rd_{pre}}$ and $\mn{rd_c \rightarrow rd_{cov}}$;
  \item if $\mn{t < rd_c.t_s}$, $\mn{o_i}$ is inactive, $\mn{rd_p \rightarrow rd_{pre}}$ and $\mn{rd_c \rightarrow rd_{suc}}$;
\end{fitemize}

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Accessing $\mn{X}$-Regions}

\textrm{object locations are bounded by either device detection ranges or cells.}

\begin{columns}[c]

  \column{.54\textwidth}
  \begin{figure}[tb]
    \includegraphics[width=\columnwidth]{figures/2-4/2-4-6.pdf}
  \end{figure}

  \column{0.48\textwidth}
  \begin{sitemize}
    \item $\mn{CovD2X: D \rightarrow IR_X}$ maps a device to an $\mn{X}$-Region that fully covers the device's detection range;
    \item $\mn{IntD2X: D \rightarrow IR_X}$ maps a device to an $\mn{X}$-Region that only intersects the device's detection range;
    \item $\mn{CovC2X: C \rightarrow IR_X}$ maps a cell to an $\mn{X}$-Region that fully covers this cell;
    \item $\mn{IntC2X: C \rightarrow IR_X}$ maps a cell to an $\mn{X}$-Region that only intersects with;
  \end{sitemize}

\end{columns}

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Processing PTISSJ Queries: Partitioning Phase}

\begin{columns}[c]

  \column{.47\textwidth}
  \vspace{-10pt}
  \begin{figure}[tb]
    \includegraphics[width=\columnwidth]{figures/2-4/2-4-7.pdf}
  \end{figure}

  \column{0.53\textwidth}
  \begin{fitemize}
    \item all indoor objects are partitioned into buckets that each refers to a distinct $\mn{X}$-region
    \item first, A1R-tree is searched to get all leaf entries whose interval $\mn{(t^{\vdash},t^{\dashv}]}$ contains the join time $\mn{t}$
    \item second, the spatial examination obtains all relevant $\mn{X}$-region in which $\mn{o_i}$ may be at time $\mn{t}$
    \item the relevant probabilities are evaluated for each object, and the necessary records are generated and added to relevant buckets, for each $\mn{p_l = pr(\Theta(o_i, x_l, t))}$, if it is larger than threshold $\mn{M}$, insert the record into buckets.
  \end{fitemize}

\end{columns}

\end{frame}

%------------------------------------------------

\begin{frame}
\frametitle{Processing PTISSJ Queries: Partitioning Phase}

\begin{columns}[c]

  \column{.5\textwidth}
  \textbf{Active State}~\\
  \ssize{
  \textrm{object $\mn{o_i}$ must be in device $\mn{dev}$'s detection range at time $\mn{t}$}.~\\
  \begin{enumerate}
    \item if the detection range is fully covered by an $\mn{X}$-region $\mn{x_l}$, as indicated by $\mn{CovD2X(dev_c) = x_l}$, a record $\mn{(o_i, 1.0)}$ is added to $\mn{x_l}$'s bucket;
    \item otherwise, $\mn{dev_c}$'s detection range intersects with each $\mn{X}$-region in $\mn{CovD2X(dev_c)}$, evaluated the probability, if it is larger than $\mn{M}$, add to the bucket.
  \end{enumerate}
  }

  \column{0.5\textwidth}
  \textbf{Inactive State}~\\
  \ssize{
  \textrm{object $\mn{o_i}$ must be in a cell in $\mn{Cells_{mid} = D2C(dev_p) \cap D2C(dev_c)}$}.~\\
  \begin{enumerate}
    \item if $\mn{Cells_{mid}}$ is the singleton set and the cell is covered by one $\mn{X}$-region $\mn{x_l}$, indicated by $\mn{CovC2X(c)= x_l}$, a record $\mn{(o_i, 1.0)}$ is added to $\mn{x_l}$'s bucket;
    \item otherwise, the single cell $\mn{c}$ in $\mn{Cells_{mid}}$ intersects with several $\mn{X}$-regions (indicated by $\mn{CovC2X(c)}$), or $\mn{Cells_{mid}}$ contains several cells.
  \end{enumerate}
  }

\end{columns}

\end{frame}
